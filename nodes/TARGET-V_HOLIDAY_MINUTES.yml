fileVersion: 1
id: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
name: V_HOLIDAY_MINUTES
operation:
  config:
    OverrideSQLCreate: false
    groupByAll: false
    insertStrategy: UNION
    secureoption: false
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13a8435c-bde6-49c0-907b-44ec72b5692d
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: VARCHAR
        description: ""
        name: SCHEDULE_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b78051b-8c14-48aa-a421-9e775d235d1b
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dafa30b-3b95-4cd9-a945-8712c8aaf408
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: TIME_ZONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 902d2b92-c1fd-4182-ac2b-96bb00bd5147
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 989de16e-adb4-459d-a4cf-d01f925230c2
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: START_TIME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28631008-282b-4a18-ad30-c0f709ccab05
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bf191bc-9e16-4851-a20e-02c3832cc16b
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: END_TIME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 188f50c9-3806-4805-9d1a-e927bb58e22e
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e98a8b6-2eae-4723-884f-9b71a758d1be
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cd48103-8adb-47fe-8168-03f80e3c1fd3
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b9b2da5-dbcd-4876-a767-97665b7d15d5
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: SCHEDULE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad374bb6-26a6-4004-bbf2-af3733fe189d
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5048252e-6f50-46b3-bbc8-4775520d84d9
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: START_TIME_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c487191c-535d-4c8d-be4d-6a4c7b37934d
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 743711c0-236f-4870-9cc3-27823941c746
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: END_TIME_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deb2ee54-78a0-4633-abd2-0285ccda1f6d
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 027e0e0c-d1fc-419d-9c8d-500207829e02
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: OFFSET_MINUTES_TO_ADD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff8287ab-2a25-4dbf-8b29-857b23e2e596
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7def05f3-33b3-4f77-9ee2-4cd1925e342b
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: VALID_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e8fd83b-23be-469d-97df-54c3f427da0f
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bffaa8a4-5c5e-4338-853a-66b6ba27afa3
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: VALID_UNTIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ff6e93b-3f92-4f57-925c-eaf5d238d1d5
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bc390e8-45c1-4f03-9745-4ad4a7ffa9be
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: HOLIDAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0622d41-7835-4257-ade9-6378d81d39a9
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a7a3d33-e1e3-4ddf-b2ac-1d2f11e52fcc
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: HOLIDAY_START_DATE_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fda2d2cb-144e-4903-aad1-220c043684a2
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f86a66ce-bc13-4047-bfb8-470142800179
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: HOLIDAY_END_DATE_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 994efd56-b752-4b68-89aa-b9f277c28d63
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 434e34af-0570-494a-9f1f-1d3f56b5ec0a
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: HOLIDAY_WEEK_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48d6bfa5-56f8-4814-ab7b-0e88ee38ab79
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aadaf099-18ff-4580-8dc7-745020ab0453
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        description: ""
        name: HOLIDAY_WEEK_END
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53882c66-f8da-4b93-81f1-0e507247c459
                stepCounter: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6667aba3-329e-4405-b9cc-764629c01de2
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        defaultValue: ""
        description: ""
        name: MINUTES_FROM_SUNDAY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              DATEDIFF(
                  MINUTE, 
                  TO_TIMESTAMP(HOLIDAY_WEEK_START), 
                  TO_TIMESTAMP(HOLIDAY_START_DATE_AT)
              ) 
              - COALESCE(PSTG_TIME_ZONE.STANDARD_OFFSET_MINUTES, 0)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5f448359-5cbe-403c-935d-76dc53c8a9ee
          stepCounter: 8c281a1f-3abb-45df-92a4-ab867a2ffc66
        config: {}
        dataType: ""
        defaultValue: ""
        description: ""
        name: MINUTES_FROM_SUNDAY_END
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              DATEDIFF(
                  MINUTE, 
                  TO_TIMESTAMP(HOLIDAY_WEEK_START), 
                  TO_TIMESTAMP(HOLIDAY_END_DATE_AT)
              ) 
              - COALESCE(PSTG_TIME_ZONE.STANDARD_OFFSET_MINUTES, 0)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          PSTG_TIME_ZONE: 2d4ed34c-c1bd-4980-a598-1d0c8e3fef7a
          V_HOLIDAY_START_END_TIMES: 06952af6-a7c7-4dd3-9272-99c8c65f81e8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: PSTG_TIME_ZONE
          - locationName: TARGET
            nodeName: V_HOLIDAY_START_END_TIMES
        join:
          joinCondition: |-
            FROM {{ ref('TARGET', 'V_HOLIDAY_START_END_TIMES') }} "V_HOLIDAY_START_END_TIMES"
            LEFT JOIN {{ ref('TARGET', 'PSTG_TIME_ZONE') }} "PSTG_TIME_ZONE"
            ON "PSTG_TIME_ZONE"."TIME_ZONE" = "V_HOLIDAY_START_END_TIMES"."TIME_ZONE"
        name: V_HOLIDAY_MINUTES
        noLinkRefs: []
  name: V_HOLIDAY_MINUTES
  overrideSQL: false
  schema: ""
  sqlType: Base:::188
  type: sql
  version: 1
type: Node
