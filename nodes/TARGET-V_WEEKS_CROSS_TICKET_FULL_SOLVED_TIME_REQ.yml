fileVersion: 1
id: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
name: V_WEEKS_CROSS_TICKET_FULL_SOLVED_TIME_REQ
operation:
  config:
    OverrideSQLCreate: false
    groupByAll: false
    insertStrategy: UNION
    secureoption: false
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e6bac47-2a7b-44a0-9298-28481efb153b
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TICKET_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 688ac258-2173-4071-9829-b86b22e98a53
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1cf0779-516e-4ae4-8c84-d42378c5d993
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        description: ""
        name: SLA_APPLIED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d2d2c29-3593-46df-9200-3b1137afbe74
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 840981d2-31f8-4a22-92a1-258a41180b3a
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        description: ""
        name: TARGET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b270c088-06da-4e1e-bf51-74af89532b0b
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a629f98e-498f-4aa9-9b11-3114735e62b0
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        description: ""
        name: SLA_POLICY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 864107f1-dca1-4cbb-9617-d34c1b65111d
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c192c2a6-e6b1-42cb-aaad-2805bff513db
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: SCEDULED_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78702f62-77a8-4ad6-bdf0-567921391af9
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f726fec7-d8a6-41da-8869-af1cd6e32b2f
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        description: ""
        name: VALID_STARTING_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9882f4b-3ce1-4a47-9902-9350c4affb5e
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 101487d7-4cdd-4ff4-838c-a9a86067317a
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        description: ""
        name: VALID_ENDING_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d08006b4-8931-447f-b44d-24a62d924464
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02af0b4a-eba4-4908-aeb1-eca580809d5f
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: STATUS_VALID_STARTING_AT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9539102-a640-41a8-99bf-9c797eb4d294
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 552596b5-1715-464b-ac07-c3a383d82ce9
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: STATUS_VALID_ENDING_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fde27dc-8fcd-4423-82f5-048d6f49bd62
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4d49c99-d3a3-4013-b07d-2d520073b605
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        description: ""
        name: VALID_STARTING_AT_IN_MINUTES_FROM_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00a092e2-c4e2-4ef8-a66d-357672763c32
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c310ce7-a18b-4086-a4ff-e28d6dd88693
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        description: ""
        name: RAW_DELTA_IN_MINUTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 954a2719-cd0e-4b2d-8453-a44f6911d3cc
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bf0152c-8839-4a02-a72f-1fa647168242
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        description: ""
        name: START_WEEK_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87a559e3-5184-4d10-b3ea-9066b67f92d0
                stepCounter: 234439e3-ec16-45b0-ae8f-0321b3b894ac
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8711a087-0096-43fd-9bce-fcc88363f70a
          stepCounter: 6aa00179-ee6f-4033-ae55-752e2da1a2e1
        config: {}
        dataType: ""
        defaultValue: ""
        description: ""
        name: WEEK_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: cast(generated_number - 1 as  INT)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          V_TICKET_FULL_SOLVED_TIME_REQ: 234439e3-ec16-45b0-ae8f-0321b3b894ac
          V_WEEKS: d9176e7c-08f4-4e67-8a2b-dd7e737f9929
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: V_TICKET_FULL_SOLVED_TIME_REQ
          - locationName: TARGET
            nodeName: V_WEEKS
        join:
          joinCondition: |
            FROM {{ ref('TARGET', 'V_TICKET_FULL_SOLVED_TIME_REQ') }} "V_TICKET_FULL_SOLVED_TIME_REQ"
            CROSS JOIN {{ ref('TARGET', 'V_WEEKS') }} "V_WEEKS"
            WHERE floor((valid_starting_at_in_minutes_from_week + raw_delta_in_minutes) / (7*24*60)) >= generated_number -1
        name: V_WEEKS_CROSS_TICKET_FULL_SOLVED_TIME_REQ
        noLinkRefs: []
  name: V_WEEKS_CROSS_TICKET_FULL_SOLVED_TIME_REQ
  overrideSQL: false
  schema: ""
  sqlType: Base:::188
  type: sql
  version: 1
type: Node
