fileVersion: 1
id: 1a561def-2797-4e8a-8baf-6f4812c05e02
name: V_WEEKS_CROSS_TICKET_FULL_SOLVED_TIME
operation:
  config:
    OverrideSQLCreate: false
    groupByAll: false
    insertStrategy: UNION
    secureoption: false
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89135b06-8a15-4b55-b61c-7612bd715d4a
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TICKET_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e53a37f1-cdf6-40ca-8539-8e8f29026421
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7ee3c73-c25e-4b99-985a-bc49b8c3fd8a
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: VARCHAR(512)
        description: ""
        name: TICKET_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b69750d2-a19d-43ce-bd99-b09901bb1106
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 419a48f6-bbfc-496c-87da-617bac77845e
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: ""
        description: ""
        name: SCHEDULE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bb3010d-d640-4fa8-bc61-dfdbb4583a04
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6b68dd8-7f5a-471a-9cfe-4760e4803135
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: ""
        description: ""
        name: STATUS_SCHEDULE_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1b0be51-c515-4898-bb61-8956e4bada32
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31358a07-1059-46cf-bad4-5c6993c59daa
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: ""
        description: ""
        name: STATUS_SCHEDULE_END
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 158e6d84-82d3-40ff-961c-a0aa91d7da6d
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83da9442-bffe-43d9-9f41-526b4328a6ad
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: STATUS_VALID_STARTING_AT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b39e6bb-a91e-4273-bd5c-99fea4bf6b2b
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 270d8274-0b96-4822-bcc6-8af056f160b3
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: STATUS_VALID_ENDING_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dbdd4fd-03c5-45ae-bbae-945a72509a72
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b680f56-eb95-4e5e-8120-d17f07a048bc
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: ""
        description: ""
        name: START_TIME_IN_MINUTES_FROM_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c7059a5-9e0d-4ed3-83c7-59388f57865a
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98db5e18-1e44-4de2-8c09-077fe9eb6360
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: ""
        description: ""
        name: RAW_DELTA_IN_MINUTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72365dd0-547a-4cc5-b6cc-5a863ac293c4
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2cd26d5-c221-4c1d-a0fb-73871b3fe112
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: ""
        description: ""
        name: START_WEEK_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8162d569-d42b-4f07-a215-25aa2fd80aea
                stepCounter: ca90abd1-241c-4e96-9e28-d754753a7c84
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 10aa79be-3254-4dbf-8778-01e344691353
          stepCounter: 1a561def-2797-4e8a-8baf-6f4812c05e02
        config: {}
        dataType: ""
        defaultValue: ""
        description: ""
        name: WEEK_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          V_TICKET_FULL_SOLVED_TIME: ca90abd1-241c-4e96-9e28-d754753a7c84
          V_WEEKS: d9176e7c-08f4-4e67-8a2b-dd7e737f9929
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: V_TICKET_FULL_SOLVED_TIME
          - locationName: TARGET
            nodeName: V_WEEKS
        join:
          joinCondition: |
            FROM {{ ref('TARGET', 'V_TICKET_FULL_SOLVED_TIME') }} "V_TICKET_FULL_SOLVED_TIME"
            CROSS JOIN {{ ref('TARGET', 'V_WEEKS') }} "V_WEEKS"
            WHERE FLOOR((start_time_in_minutes_from_week + raw_delta_in_minutes) / (7 * 24 * 60)) >= generated_number - 1
        name: V_WEEKS_CROSS_TICKET_FULL_SOLVED_TIME
        noLinkRefs: []
  name: V_WEEKS_CROSS_TICKET_FULL_SOLVED_TIME
  overrideSQL: false
  schema: ""
  sqlType: Base:::188
  type: sql
  version: 1
type: Node
