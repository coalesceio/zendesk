fileVersion: 1
id: 1812197f-ef20-47ed-a443-791730f232c1
name: V_INT_TICKET_AGGREGATES
operation:
  config:
    OverrideSQLCreate: false
    groupByAll: false
    insertStrategy: UNION
    secureoption: false
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03e1b833-8122-4402-ad9e-0a8c3007f2f7
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER
        description: ""
        name: PSTG_TICKET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97a0d1e0-8ee3-42d6-a115-3723d16bafea
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ba9c16c-b791-4ed3-90ce-644d4ce4a3e7
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TICKET_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d25d46d-f272-4be2-b448-466110cae13a
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b2f70a1-81e5-498c-9e90-c2b8fe8d139d
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f387e7dc-778f-46b6-8a1f-2ab9237ced60
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9efdedb3-adc9-4417-a3f1-a64cc7e87083
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ASSIGNEE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a74bffea-6801-4b2c-8287-880e1192180b
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0764e61a-1779-4907-ae84-769d12e42a73
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: BRAND_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 131388ec-b5b3-4f44-b3b6-802e68667d39
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: becbcc06-92f1-4496-88e3-f52d9f020fa2
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9c7abcd-bdbf-4645-b09c-b7d5eb16fbcb
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4fdc954-29a1-4776-b4fe-03a1bf42ed92
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 036353f2-0bbe-44b7-8a32-f9884cc60b3e
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eaa06d5-739f-4824-8067-38cc5402f4d7
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(65536)
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10b424af-7e32-45b2-91ad-463e3928d37d
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91aa6c83-eb02-4204-93e5-ae5fc2bb3d90
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: DUE_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16d09ce2-2383-49f3-86ed-b5b67a39eba9
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81766bd8-57b5-4e48-98c5-a4b57d9582f2
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: GROUP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9a9194c-fdcb-4ce5-89c0-eba58967273f
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e8a74ca-8db8-419a-9836-26dbf60ed1f7
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: EXTERNAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 039eddf0-21de-4eea-936d-8174fbe1e12c
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dc153fa-1414-41a0-b394-7920b59143a3
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: BOOLEAN
        description: ""
        name: IS_PUBLIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3b10ff9-673f-48d8-9b99-cc854faa3f0b
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03ccafa4-82e7-4065-a99d-e5f7ab8f3f10
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORGANIZATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f26f7d19-fd7f-43ad-b688-dfd6f206ce88
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59057a75-8b2a-4320-bb7f-5e41172dd1df
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f872be46-b38a-4816-98b1-ff22a120ed64
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ffb8e6-ed27-4980-a51a-633478ab7d8d
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: RECIPIENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b75ea146-fee5-4c87-810d-baf27535b586
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c01e5187-e31a-498d-861e-5e786d52c0e8
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: REQUESTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13d6c927-5a52-41e4-afe1-6fbb1daa2ddd
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ed59891-a367-482a-8495-201f1d9c0d1e
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a5d06f1-1481-4ccb-b2fb-e91bd5c6c184
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b488fe5-b9c1-45c0-9714-624a5dffa154
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: SUBJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a84378b-b779-464d-aa0e-4db1a42f7424
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a5c8a14-132a-41d7-af01-bb8204f553ce
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PROBLEM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5304f7ca-983d-46af-a7aa-adf6846481b4
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 063314e8-294c-40d5-8825-863fd5996f54
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SUBMITTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6323e35b-813a-4f84-8a61-3c7d6c0e0f9c
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4a39b46-8417-4eb5-994f-dc42373984ac
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TICKET_FORM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac10ad8b-b033-4aa1-8e44-98edc16dab50
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a56bb733-7759-47b4-9f78-50a0df227957
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c331951c-8294-431f-b4ff-319328f1a53e
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b6897c1-e829-41ae-82f9-5aadf806c59c
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6335d3c-2034-42da-a088-a4f181b1cab3
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 916cc667-7d7e-441d-9113-ca05df0334bb
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: VIA_CHANNEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb28546-9926-4fd5-850d-375977d08843
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01716f2e-1ffd-43f9-9b65-be55961ef1da
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: VIA_SOURCE_FROM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29e1bb4c-162b-4855-a83c-c8d6450e682e
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 147a752d-63d0-4d31-ac8d-e762a80295a1
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: VIA_SOURCE_FROM_TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7712275-073f-4c1f-a864-fa236b6a2df7
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c90dd6b-458c-413b-aff7-d68914283f10
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: VIA_SOURCE_REL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a68f703-0c8a-400c-a7f2-10d338770404
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b011bd6-5eaa-4d22-a238-5e2245448fc0
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: VIA_SOURCE_FROM_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 557846cc-8c10-4a2b-812c-a94c5fb1ba8d
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cc75ceb-83cf-4cdb-bcc0-a5ea98bee28d
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: VIA_SOURCE_TO_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 760f9c6d-9c73-4720-a780-742efd2c3f34
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a43c7357-50aa-4a2b-8adf-4d3a750bca8c
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: NUMBER
        description: ""
        name: SYSTEM_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81afa674-fa2b-4b0d-b8f4-5ec471303cb6
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74b9f7a9-db83-4337-b923-512f321414d7
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: VARCHAR
        description: ""
        name: SYSTEM_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5391026-e088-41b6-8a71-5c2c2560135c
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f92980a-f397-4c3b-bcd4-eed1f0394653
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: SYSTEM_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9212c6c-e2dd-468e-8e26-be3bf2ea86e4
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 705899cd-1832-4b18-ac57-7f6f79ed97bf
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: SYSTEM_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 594a22db-8bce-4833-9550-ea95f69c83b8
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97a91650-51a9-41f9-b918-4d0c67bd0d3e
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: SYSTEM_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 321f344a-8bc1-4ca2-a0f0-c85a4afe70a8
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e9eb111-acd8-411d-bc37-a69b69c710a6
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: TIMESTAMP
        description: ""
        name: SYSTEM_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ee37201-fc88-4c13-9d66-3e87b2ffff7d
                stepCounter: 2630639b-14e3-4546-838d-4100786f9216
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cf99a864-4051-41aa-8ac9-f7355bbbd471
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: ""
        defaultValue: ""
        description: ""
        name: IS_INCIDENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN LOWER("PSTG_TICKET"."TYPE") = 'INCIDENT' 
              THEN TRUE 
              ELSE FALSE 
              END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a6b9f8f9-ada7-4fbf-ae47-768d5319ea7d
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: ""
        defaultValue: ""
        description: ""
        name: TICKET_BRAND_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cce62ae7-ef33-4d60-8c96-0c38b16dca85
                stepCounter: bc1c42ee-f79c-458a-aa3c-08bb1bf7ee06
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7c6126fd-3eb4-4ce8-8f3c-8454c7b6ddf4
          stepCounter: 1812197f-ef20-47ed-a443-791730f232c1
        config: {}
        dataType: ""
        defaultValue: ""
        description: ""
        name: TICKET_TAGS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d02ec81-3341-47d0-b1fe-cfb568ec8309
                stepCounter: 57b27b89-601d-4c8d-9b7c-c619ac8e8d33
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          PSTG_BRAND: bc1c42ee-f79c-458a-aa3c-08bb1bf7ee06
          PSTG_TICKET: 2630639b-14e3-4546-838d-4100786f9216
          V_TICKET_TAG_AGGREGATE: 57b27b89-601d-4c8d-9b7c-c619ac8e8d33
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: PSTG_BRAND
          - locationName: TARGET
            nodeName: PSTG_TICKET
          - locationName: TARGET
            nodeName: V_TICKET_TAG_AGGREGATE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET', 'PSTG_TICKET') }} "PSTG_TICKET"
            LEFT JOIN {{ ref('TARGET', 'V_TICKET_TAG_AGGREGATE') }} "V_TICKET_TAG_AGGREGATE"
            ON "V_TICKET_TAG_AGGREGATE"."TICKET_ID" = "PSTG_TICKET"."TICKET_ID"
            LEFT JOIN {{ ref('TARGET', 'PSTG_BRAND') }} "PSTG_BRAND"
                ON "PSTG_BRAND"."BRAND_ID" = "PSTG_TICKET"."BRAND_ID"
        name: V_INT_TICKET_AGGREGATES
        noLinkRefs: []
  name: V_INT_TICKET_AGGREGATES
  overrideSQL: false
  schema: ""
  sqlType: Base:::188
  type: sql
  version: 1
type: Node
